{% extends "base.html" %}
{% block content %}
<div class="card p-3 mb-4 bg-primary text-white shadow">
    <h4>Bem-vindo, {{ user.nome }}</h4>
    <p class="mb-0">Acesso: <strong>{{ user.cargo_sistema }}</strong> 
       {% if user.cargo_politico %} | Pleiteando: <strong>{{ user.cargo_politico }}</strong>{% endif %}
    </p>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="card text-center p-3 shadow-sm">
            <h1 class="display-4 text-primary">{{ total_eleitores }}</h1>
            <p class="text-muted uppercase">Eleitores Cadastrados</p>
        </div>
    </div>
</div>

{% if user.cargo_sistema == 'CRIADOR' %}
<div class="card p-4 mb-4 border-success shadow-sm">
    <h5><i class="bi bi-person-plus"></i> Cadastrar Dr. Marinho (Candidato)</h5>
    <form action="/cadastrar_candidato" method="post" class="mt-3">
        <div class="row g-2">
            <div class="col-md-6"><input type="text" name="nome" placeholder="Nome do Candidato" class="form-control mb-2" required></div>
            <div class="col-md-6">
                <select name="cargo_politico" class="form-select mb-2">
                    {% for cargo in cargos_politicos %}
                    <option value="{{ cargo }}">{{ cargo }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-6"><input type="text" name="login" placeholder="Login para ele" class="form-control mb-2" required></div>
            <div class="col-6"><input type="password" name="senha" placeholder="Senha para ele" class="form-control mb-2" required></div>
        </div>
        <button type="submit" class="btn btn-success w-100">Salvar Candidato</button>
    </form>
</div>
{% endif %}

{% if user.cargo_sistema == 'LIDERANCA' %}
<div class="card p-4 mb-4 border-info shadow-sm">
    <h5>Cadastrar Novo Eleitor na sua Base</h5>
    <form action="/cadastrar_eleitor" method="post" class="mt-2">
        <input type="text" name="nome" placeholder="Nome Completo" class="form-control mb-2" required>
        <div class="row g-2 mb-2">
            <div class="col-6"><input type="text" name="titulo" placeholder="Nº Título" class="form-control"></div>
            <div class="col-3"><input type="text" name="zona" placeholder="Zona" class="form-control"></div>
            <div class="col-3"><input type="text" name="secao" placeholder="Seção" class="form-control"></div>
        </div>
        <input type="text" name="contato" placeholder="WhatsApp" class="form-control mb-2">
        <button type="submit" class="btn btn-primary w-100">Finalizar Cadastro</button>
    </form>
</div>
{% endif %}

<div class="card p-3 shadow-sm">
    <h5>Lista de Cadastrados</h5>
    <div class="table-responsive">
        <table class="table table-striped table-hover mt-2">
            <thead class="table-dark">
                <tr>
                    <th>Nome</th>
                    <th>Título/Z/S</th>
                    <th>WhatsApp</th>
                    <th>Liderança</th>
                </tr>
            </thead>
            <tbody>
                {% for e in lista_eleitores %}
                <tr>
                    <td>{{ e.nome }}</td>
                    <td><small>{{ e.titulo }} | {{ e.zona }}/{{ e.secao }}</small></td>
                    <td>{{ e.contato }}</td>
                    <td><span class="badge bg-secondary">{{ e.lideranca_nome }}</span></td>
                </tr>
                {% empty %}
                <tr><td colspan="4" class="text-center text-muted">Nenhum registro encontrado.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
